var GAME=function(e,t,n){function c(){r.empty();l.acnes=[];var t=[];for(var n=0;n<l.NoOfAcne;n++){var i=h(e,t);t.push(i);var s=new Acne(l,n+1,e[i]);l.acnes.push(s);r.append(s.beforeElement);r.append(s.afterElement);r.append(s.liquidElement);r.append(s.textElement);setTimeout(s.start,l.waitingTime)}return l.acnes}function h(e,t){while(1){var n=_.random(0,e.length-1);if(t.indexOf(n)==-1){return n}}}function p(e){if(e==0){i.html("<span class='second'>开始</span>");return}i.find(".second").text(e);setTimeout(function(){p(--e)},1e3)}var r=t.find(".girl-acne-wrap"),i=t.find(".banner-text-countdown"),s=n.find("#acneNo"),o=n.find("#acneTitle"),u=n.find("#acneDesc"),a=n.find(".mask-img"),f=n.find(".mask");var l={maxNoOfAcne:11,level:0,NoOfAcne:2,totalAcne:0,sequence:1,acnes:[],waitingTime:3e3,status:0,remarks:[{title:"初生挤痘士",desc:"相信你是手抖点错了，赶紧再来过吧"},{title:"菜鸟挤痘士",desc:"一只小呀小菜鸟，加油成长起来"},{title:"稀泥挤痘士",desc:"痘痘君都在笑你了，给点力吧稀泥痘士"},{title:"水泥挤痘士",desc:"不错不错，再努努力，单车变摩托"},{title:"生铁挤痘士",desc:"不错不错，再努努力，单车变摩托"},{title:"不锈钢挤痘士",desc:"干得漂亮，你绝对是个合格的挤痘士"},{title:"青铜挤痘士",desc:"good！连女神雅典娜都要赞扬你的战痘能力了"},{title:"白银挤痘士",desc:"太棒了，恭喜你成为挤痘士中的高级人才"},{title:"黄金挤痘士",desc:"你的能力已经让痘痘君闻风丧胆"},{title:"白金挤痘士",desc:"你的能力已经让痘痘君闻风丧胆"},{title:"钛合金挤痘士",desc:"这绝对是个凤毛麟角的成绩，太赞了！"},{title:"钻石挤痘士",desc:"离神最近的痘士，你该接受好友的膜拜"},{title:"神级挤痘士",desc:"你就是存在于传说中的神级挤痘士！还不炫耀炫耀"}]};l.validate=function(e){if(this.sequence==e.index){this.sequence++;this.totalAcne++;if(this.sequence>this.NoOfAcne){return 2}return 1}l.end();return 0};l.nextLevel=function(){l.status=0,l.sequence=1,l.NoOfAcne++;if(l.NoOfAcne>=6){l.waitingTime=4e3}if(l.NoOfAcne>l.maxNoOfAcne){l.end()}else{c();i.html('<span>还有</span> <span class="second">4</span> <span>秒，抓紧时间记忆</span>');p(l.waitingTime/1e3)}};l.end=function(){var e=this.totalAcne;this.status=1;s.text(this.totalAcne);if(this.totalAcne>60)e=60;var r=Math.floor(e/5);o.text(this.remarks[r].title+" (lv"+r+")");u.text(this.remarks[r].desc);this.level=r;t.hide();n.show()};l.restart=function(){this.currentLevel=1,this.NoOfAcne=2,this.totalAcne=0,this.sequence=1,this.level=0,this.acnes=[];t.show();n.hide();this.nextLevel()};l.share=function(){a.show();f.show()};l.unShare=function(){a.hide();f.hide()};return l};var Acne=function(e,t,n){var e=e;var r=this;var i={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return i.Android()||i.BlackBerry()||i.iOS()||i.Opera()||i.Windows()}};this.index=t;this.position=n;this.isDied=false;this.isStart=false;this.start=function(){r.isStart=true;r.textElement.childNodes[0].innerText="?";r.textElement.childNodes[0].textContent="?";r.textElement.style.marginTop="-14px";r.textElement.style.marginLeft="23px";r.beforeElement.style.display="block"};this.open=function(){if(!r.isStart||r.isDied)return;var t=e.validate(r);if(t){r.isDied=true;r.liquidElement.style.display="block";r.textElement.style.display="none";r.beforeElement.style.display="none";setTimeout(function(){r.liquidElement.style.display="none";r.afterElement.style.display="block";r.textElement.style.display="block";r.textElement.childNodes[0].innerText=r.index;r.textElement.childNodes[0].textContent=r.index;if(t==2){e.nextLevel()}},500)}};var s=document.createElement("div");s.id="text-"+this.index;s.className="girl-text";s.style.left=this.position.x;s.style.top=this.position.y;if(s.addEventListener){if(i.any()){s.addEventListener("touchstart",this.open,false)}else{s.addEventListener("mousedown",this.open,false)}}else if(s.attachEvent){if(i.any()){s.attachEvent("touchstart",this.open,false)}else{s.attachEvent("mousedown",this.open,false)}}var o=document.createElement("span");o.className="span"+_.random(1,4);o.textContent=this.index;o.innerText=this.index;s.appendChild(o);var u=document.createElement("div");u.id="before-"+this.index;u.className="girl-acne";u.style.left=this.position.x;u.style.top=this.position.y;if(u.addEventListener){if(i.any()){u.addEventListener("touchstart",this.open,false)}else{u.addEventListener("mousedown",this.open,false)}}else if(u.attachEvent){if(i.any()){u.attachEvent("touchstart",this.open,false)}else{u.attachEvent("mousedown",this.open,false)}}var a=document.createElement("img");a.src="images/acne.png";u.appendChild(a);var f=document.createElement("div");f.id="after-"+this.index;f.className="girl-acne";f.style.left=this.position.x;f.style.top=this.position.y;f.style.display="none";var a=document.createElement("img");a.src="images/deadacne.png";f.appendChild(a);var l=document.createElement("div");l.id="liquid-"+this.index;l.className="girl-liquid";l.style.left=this.position.x;l.style.top=this.position.y;var a=document.createElement("img");a.src="images/liquid.png";l.appendChild(a);this.beforeElement=u;this.afterElement=f;this.liquidElement=l;this.textElement=s}