var GAME=function(e,t,n){function c(){r.empty();l.acnes=[];var t=[];for(var n=0;n<l.NoOfAcne;n++){var i=h(e,t);t.push(i);var s=new Acne(l,n+1,e[i]);l.acnes.push(s);r.append(s.beforeElement);r.append(s.afterElement);r.append(s.liquidElement);r.append(s.textElement);setTimeout(s.start,l.waitingTime)}return l.acnes}function h(e,t){while(1){var n=_.random(0,e.length-1);if(t.indexOf(n)==-1){return n}}}function p(e){if(e==0){i.html("<span class='second'>开始</span>");return}i.find(".second").text(e);setTimeout(function(){p(--e)},1e3)}var r=t.find(".girl-acne-wrap"),i=t.find(".banner-text-countdown"),s=n.find("#acneNo"),o=n.find("#acneTitle"),u=n.find("#acneDesc"),a=n.find(".mask-img"),f=n.find(".mask");var l={maxNoOfAcne:11,level:0,NoOfAcne:2,totalAcne:0,sequence:1,acnes:[],waitingTime:3e3,status:0,remarks:[{title:"初生挤痘士",desc:"相信你是手抖点错了，赶紧再来过吧"},{title:"菜鸟挤痘士",desc:"一只小呀小菜鸟，加油成长起来"},{title:"稀泥挤痘士",desc:"痘痘君都在笑你了，给点力吧稀泥痘士"},{title:"水泥挤痘士",desc:"不错不错，再努努力，单车变摩托"},{title:"生铁挤痘士",desc:"不错不错，再努努力，单车变摩托"},{title:"不锈钢挤痘士",desc:"干得漂亮，你绝对是个合格的挤痘士"},{title:"青铜挤痘士",desc:"good！连女神雅典娜都要赞扬你的战痘能力了"},{title:"白银挤痘士",desc:"太棒了，恭喜你成为挤痘士中的高级人才"},{title:"黄金挤痘士",desc:"你的能力已经让痘痘君闻风丧胆"},{title:"白金挤痘士",desc:"你的能力已经让痘痘君闻风丧胆"},{title:"钛合金挤痘士",desc:"这绝对是个凤毛麟角的成绩，太赞了！"},{title:"钻石挤痘士",desc:"离神最近的痘士，你该接受好友的膜拜"},{title:"神级挤痘士",desc:"你就是存在于传说中的神级挤痘士！还不炫耀炫耀"}]};l.validate=function(e){if(this.sequence==e.index){this.sequence++;this.totalAcne++;if(this.sequence>this.NoOfAcne){return 2}return 1}l.end();return 0};l.nextLevel=function(){l.status=0,l.sequence=1,l.NoOfAcne++;if(l.NoOfAcne>=6){l.waitingTime=4e3}if(l.NoOfAcne>l.maxNoOfAcne){l.end()}else{c();i.html('<span>还有</span> <span class="second">4</span> <span>秒，抓紧时间记忆</span>');p(l.waitingTime/1e3)}};l.end=function(){var e=this.totalAcne;this.status=1;s.text(this.totalAcne);if(this.totalAcne>60)e=60;var r=Math.floor(e/5);o.text(this.remarks[r].title);u.text(this.remarks[r].desc);this.level=r;t.hide();n.show()};l.restart=function(){this.currentLevel=1,this.NoOfAcne=2,this.totalAcne=0,this.sequence=1,this.level=0,this.acnes=[];t.show();n.hide();this.nextLevel()};l.share=function(){a.show();f.show()};l.unShare=function(){a.hide();f.hide()};return l};var Acne=function(e,t,n){var e=e;var r=this;this.index=t;this.position=n;this.isDied=false;this.start=function(){r.textElement.childNodes[0].innerText="?";r.textElement.style.marginTop="-14px";r.textElement.style.marginLeft="16px";r.beforeElement.style.display="block"};this.open=function(){if(r.isDied)return;var t=e.validate(r);if(t){r.isDied=true;r.liquidElement.style.display="block";setTimeout(function(){r.liquidElement.style.display="none";r.afterElement.style.display="block";r.textElement.childNodes[0].innerText=r.index;if(t==2){e.nextLevel()}},500)}else{console.log("wrong")}};var i=document.createElement("div");i.id="text-"+this.index;i.className="girl-text";i.style.left=this.position.x;i.style.top=this.position.y;var s=document.createElement("span");s.innerText=this.index;i.appendChild(s);var o=document.createElement("div");o.id="before-"+this.index;o.className="girl-acne";o.style.left=this.position.x;o.style.top=this.position.y;o.onclick=this.open;o.addEventListener("touchstart",this.open);var u=document.createElement("img");u.src="images/acne.png";o.appendChild(u);var a=document.createElement("div");a.id="after-"+this.index;a.className="girl-acne";a.style.left=this.position.x;a.style.top=this.position.y;a.onclick=this.open;var u=document.createElement("img");u.src="images/deadacne.png";a.appendChild(u);var f=document.createElement("div");f.id="liquid-"+this.index;f.className="girl-liquid";f.style.left=this.position.x;f.style.top=this.position.y;f.onclick=this.open;var u=document.createElement("img");u.src="images/liquid.png";f.appendChild(u);this.beforeElement=o;this.afterElement=a;this.liquidElement=f;this.textElement=i}